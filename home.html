<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">

    <title>Isaah Hideout</title>



    <!--PDF-->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script> 


<!--image-->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script> -->



<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>



    
  </head>
  <body>

    <nav class="navbar navbar-light bg-nav">
  <a class="navbar-brand text-white" href="#">Isaah Hangout</a>
  <button class="btn btn-sm btn-primary ml-auto">Cashier</button>
  <button class="btn btn-sm btn-primary ml-2" onclick="goToStocks()">Inventory</button>
  <div class="col-md-2" id="search-el" style="display: none;">
    <input type="text" class="form-control" id="search-input" placeholder="search something..">
  </div>
</nav>
    
    <div class="contain">
      <div class="row">
        <div class="col-md-3 p-3 cart">
          <div class="type-buying">
            <select name="buy-type" id="buy-type" class="form-control mb-2 bg-primary text-white">
              <option class="bg-white" value="Cash">Cash</option>
              <option class="bg-white" value="Credit">Credit</option>
            </select>
          </div>     
          
          <div class="item-list mt-2">
            <div id="loop-invoice">
              <!-- loop item -->
            </div>
          </div>
          <div class="amount">
            <span>Tax : PHP <span id="tax">0</span></span>
            <br>
            <span>Total : PHP <span id="total">0</span></span>
          </div>
        </div>
        <div class="col-md-9 p-3 menu">
          <div class="sub-nav bg-white">
            <div class="row">
              <div class="col-md-4">
                <h5 class="my-0">Menu List</h5>
              </div>
              <div class="col-md-4">
                <h5 class="my-0 text-center" id="name-cat">Choose a Product</h5>
              </div>
              <div class="col-md-4">
                <div class="nav-btn float-right">

                  <div class="dropdown float-left mr-1">
                    <button class="btn btn-sm dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      <img src="https://img.icons8.com/material-rounded/24/000000/menu-2.png">
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                      <a class="dropdown-item" href="#" id="drink">drink</a>

                      <a class="dropdown-item" href="#" id="food">food</a>
                      
                    </div>
                  </div>

                  <button class="btn btn-sm" id="search-btn"><img src="https://img.icons8.com/android/24/000000/search.png"></i></button>

                  <button class="btn btn-sm" id="sort"><img src="https://img.icons8.com/ios-glyphs/24/000000/generic-sorting-2.png"></i></button>
                </div>
              </div>
            </div>
          </div>
          <div class="row mt-3" id="loop-card">

            <!-- loop el -->

          </div>
        </div>
      </div>

      <div class="buy">
        <div class="row">
          <div class="col-md-3">
            <button onclick="remove_invoice()" class="btn btn-outline-danger remove-all">Remove All</button>
          </div>
          <div class="col-md-9">
            <div class="input-group mb-3">
              <input type="text" id="money" class="form-control" placeholder="Amount of Payment" aria-label="Recipient's username" aria-describedby="button-addon2">
              <div class="input-group-append">
                <button type="button" id="buy" class="btn btn-primary" data-toggle="modal">
                  Payment <span><img src="https://img.icons8.com/material-rounded/24/ffffff/heck-for-payment.png"></span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>



    <!-- Modal -->
    <div class="modal fade" id="modal-invoice" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title" id="exampleModalLabel">Receipt</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <center>
              <span><img id="logo-img" src="assets/logo.png"></span>

              <h6>Isaah Hideout</h6>
              <p>(+63) 956-273-4369</p>
              <p>001 b Sitio Nazareth, Barangay San Isdro, Paranaque City</p>
              <p>Manager: Naivelyn Felipe</p>
              <p>Cashier: Karl Benjamin R  Bughaw</p>
              <p>Date/Time: <p><span id="date-time"></span></p></p>
            <p>Order No.</p>

            <p><span id="order-number"></span></p>

            </center>
            <center>
            <p>_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _</p>
            </center>
            
            <h5>Mode of payment</h5>
              <p id="total-type"></p>
            <h5>Order</h5>
            <div id="total-item">
              <!-- loop total -->
            </div>
            <div id="total-payment mt-4">
              <p class="text-right">Tax (2%): PHP <span id="tax-in"></span></p>
              <p class="text-right">Total : PHP <span id="total-in"></span></p>
              <p class="text-right">Money : PHP <span id="money-in"></span></p>
              <p class="text-right">Change : PHP <span id="change-in"></span></p>
            </div>
            <center>
            <svg id="barcode"></svg>
            </center>
            <center>
            <p>_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _</p>
            </center>
            <p class="text-center">"Like" Isaah Hideout on Facebook</p>
            <p class="text-center">https://facebook.com/IsaahHideout</p>
            <p class="text-center">If there was an issue you can contact our support on Facebook</p>
            <h6 class="text-center">Thank You! </h6>
            <h6 class="text-center">please come again.</h6> 
            
            
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal" id="end-payment">End Payment</button>
            <button type="button" class="btn btn-secondary" id="print-receipt">Print Receipt</button>

          </div>
        </div>
      </div>
    </div>



 



























    


  
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>








    

    <script>
  // Function to generate a random order number
  function generateOrderNumber() {
    return Math.floor(Math.random() * 1000000); // Adjust as needed for your order number length
  }









      function goToHome() {
            window.location.href = 'home.html';
        }
      function goToStocks() {
            window.location.href = 'stocks.html';
        }











//pdf
      /*
    function printReceipt() {
    const doc = new jsPDF();
    const element = document.getElementById('modal-invoice');

    html2canvas(element).then((canvas) => {
        const imageData = canvas.toDataURL('image/png');

        const newHeight = 297; 


        doc.addImage(imageData, 'PNG', 0, 0, 210, newHeight); 
        doc.save('receipt.pdf');
    });
}

$('#print-receipt').on('click', printReceipt);
*/

            




    function printReceipt() {
    const element = document.getElementById('modal-invoice');

    // Set the dimensions of the canvas to match the modal's scrollable content
    const canvas = document.createElement('canvas');
    canvas.width = element.scrollWidth;
    canvas.height = element.scrollHeight;

    // Capture the entire modal content as an image
    html2canvas(element, { canvas }).then((canvas) => {
        // Convert canvas data to a PNG image
        const imageData = canvas.toDataURL('image/png');

        // Create a new image element
        const img = new Image();
        img.src = imageData;

        // Append the image to the document (optional)
        document.body.appendChild(img);

        // Save the image as a file (customize the filename)
        const link = document.createElement('a');
        link.href = imageData;
        link.download = 'receipt.png';
        link.click();
    });
}

// Attach the printReceipt function to the button click event
$('#print-receipt').on('click', printReceipt);







      function getCurrentDateTime() {
    const now = new Date();
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric' };
    return now.toLocaleDateString('en-US', options);
  }


    // Update date and time
    const dateTime = getCurrentDateTime();{
    document.getElementById('date-time').textContent = dateTime;
    }


      

  // Function to update the receipt modal with order number and barcode
  function updateReceipt(orderNumber) {
    // Update order number
    document.getElementById('order-number').textContent = orderNumber;

    // Generate barcode
    JsBarcode("#barcode", orderNumber);
  }
// Call this function when the receipt modal is shown
  $('#modal-invoice').on('shown.bs.modal', function () {
    const orderNumber = generateOrderNumber();
    updateReceipt(orderNumber);
  });



// Function to update the stock display in the table
function updateStockTable() {
  $('#stock-table-body').html(''); // Clear existing table rows

  // Loop through each product in the data array
  data.forEach(function(product) {
    const type = product[0];
    const name = product[1];
    const price = product[2];
    const description = product[3];
    const stock = stocks[name.replace(/ /g, "_")]; // Get the stock quantity for the product

    // Create a table row for the product
    const tableRow = `
      <tr>
        <td>${type}</td>
        <td>${name}</td>
        <td>${price}</td>
        <td>${description}</td>
        <td>${stock}</td>
      </tr>
    `;

    // Append the table row to the tbody element
    $('#stock-table-body').append(tableRow);
  });
}

// Call the function to update the initial stock table display
updateStockTable();
      
</script>





    <div class="container mt-3">
        <h1>Product Listing</h1>
        <table class="table">
            <thead>
                <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Price</th>
                    <th>Description</th>
                    <th>Stock</th>
                </tr>
            </thead>
            <tbody>
          place the data below with your actual product data -->
                <!-- Loop through each product and add a row for each -->
                <tr>
                    <td>Drink</td>
                    <td>1 Bucket of Redhorse</td>
                    <td>500</td>
                    <td>Lakas Tama Pero Di Wasak</td>
                    <td><span id="stock1"></span></td>
                </tr>
                <!-- Add other product rows similarly -->
                <tr>
                    <td>Drink</td>
                    <td>Black Label</td>
                    <td>2000</td>
                    <td>Wasak na Wasak</td>
                    <td><span id="stock2"></span></td>
                </tr>
                <!-- Repeat this block for each product -->
                <!-- Ensure to replace '1', '2', etc. in id="stockX" with corresponding numbers -->
                <!-- E.g., id="stock3" for the third product, id="stock4" for the fourth, and so on -->
                <!-- Use the same pattern for the other fields -->
                <tr>
                    <td>Drink</td>
                    <td>Blowjob Tower</td>
                    <td>1500</td>
                    <td>Walang Kasing Sarap</td>
                    <td><span id="stock3"></span></td>
                </tr>
                <tr>
                    <td>Drink</td>
                    <td>Emperador</td>
                    <td>1200</td>
                    <td>Nalasing</td>
                    <td><span id="stock4"></span></td>
                </tr>
                <tr>
                    <td>Drink</td>
                    <td>Jack Daniels</td>
                    <td>1500</td>
                    <td>takas na</td>
                    <td><span id="stock5"></span></td>
                </tr>
                <tr>
                    <td>Drink</td>
                    <td>Juice</td>
                    <td>100</td>
                    <td>weak</td>
                    <td><span id="stock6"></span></td>
                </tr>
                <tr>
                    <td>Drink</td>
                    <td>Tequila</td>
                    <td>1500</td>
                    <td>Lovable Taste</td>
                    <td><span id="stock7"></span></td>
                </tr>
                <tr>
                    <td>Drink</td>
                    <td>Water</td>
                    <td>50</td>
                    <td>mabait</td>
                    <td><span id="stock8"></span></td>
                </tr>
                <tr>
                    <td>Food</td>
                    <td>Chicharon</td>
                    <td>100</td>
                    <td>tanpulu</td>
                    <td><span id="stock9"></span></td>
                </tr>
                <tr>
                    <td>Food</td>
                    <td>Chicharon Bulaklak</td>
                    <td>100</td>
                    <td>Crispy Pork</td>
                    <td><span id="stock10"></span></td>
                </tr>
                <tr>
                    <td>Food</td>
                    <td>Lechon Kawali with Cheese</td>
                    <td>200</td>
                    <td>Sobrang Sarap</td>
                    <td><span id="stock11"></span></td>
                </tr>
                <tr>
                    <td>Food</td>
                    <td>Sisig</td>
                    <td>135</td>
                    <td>solid sarap</td>
                    <td><span id="stock12"></span></td>
                </tr>
                <tr>
                    <td>Food</td>
                    <td>Sizzling Hotdog</td>
                    <td>200</td>
                    <td>juts pero madami</td>
                    <td><span id="stock13"></span></td>
                </tr>
            </tbody>
        </table>
    </div>

















    

    

    

    
    <script>
      const data = [
    [
        'drink',
        "1 Bucket of Redhorse",
        500,
        "Lakas Tama Pero Di Wasak",
        "1-Bucket-Redhorse.png"
    ],
    [
        'drink',
        "Black Label",
        2000,
        "Wasak na Wasak",
        "blacklabel.png"
    ],
    [
        'drink',
        "Blowjob Tower",
        1500,
        "Walang Kasing Sarap",
        "Blowjob-Tower.png"
    ],
    [
        'drink',
        "Emperador",
        1200,
        "Nalasing",
        "emperador.png"
    ],
    [
        'drink',
        "Jack Daniels",
        1500,
        "takas na",
        "Jack-Daniels.png"
    ],
    [
        'drink',
        "Juice",
        100,
        "weak",
        "juice.jpg"
    ],
    [
        'drink',
        "Tequila",
        1500,
        "Lovable Taste",
        "Tequila.png"
    ],
    [
        'drink',
        "Water",
        50,
        "mabait",
        "water.jpg"
    ],
    [
        'food', 
        "Chicharon", 
        100,
        "tanpulu",
        "chicha.jpg"
    ],
    [
        'food', 
        "Chicharon Bulaklak", 
        100,
        "Crispy Pork",
        "chicharon.jpg"
    ],
    [
        'food',
        "Lechon Kawali with Cheese",
        200,
        "Sobrang Sarap",
        "crispypata.png"
    ],
    [
        'food',
        "Sisig",
        135,
        "solid sarap",
        "sisig.jpg"
    ],
    [
        'food',
        "Sizzling Hotdog",
        200,
        "juts pero madami",
        "hotdog.jpg"
    ]
];


// global variable
let invoice_item = []
let sub_total = 0
let total = 0
let tax = 0
let price = 0
let input_postion = 0

// first loop
let title = $('#name-cat').text()
if(title == 'Food'){
    food_cat()
}

//category sorting
$('#food').on('click', function(){
    $('#name-cat').text('Food')
    food_cat()
})

$('#drink').on('click', function(){
    drink_cat()
})

// reverse
$('#sort').on('click', function(){
    let cat_sort = $('#name-cat').text().toLowerCase()
    if(cat_sort == 'drink'){
        console.log('click drink')
        data.reverse()
        drink_cat()
    }else{
        console.log('click food')
        data.reverse()
        $('#loop-card').html('')
        food_cat()
    }
})

//search
$('#search-btn').click(() => {
    $('#search-el').toggle()
})

$('#search-input').on('keyup',function(){
    const qvalue = $('#search-input').val()
    const filter = qvalue.toUpperCase()
    const parentCard = document.getElementById('loop-card')
    const card = parentCard.getElementsByClassName('subCardParent')
    for(let i = 0; i < card.length; i++){
        let text = card[i].getElementsByTagName('h5')[0]
        let title = text.textContent
        if(title.toUpperCase().indexOf(filter) > -1){
            card[i].style.display = 'block'
        }else{
            card[i].style.display = 'none'
        }
    }
})

function food_cat(){
    $('#loop-card').html('')
    let key = $('#food').text().toLowerCase()
    $.each(data, function(i, val){
        if(val[0] == key){
            const el_card = `
                <div class="col-md-3 mb-4 subCardParent" onclick="invoice_data('${val[4]}','${val[1]}',${val[2]})">
                    <div class="card">
                    <img src="assets/${val[4]}" class="card-img-top" height="130">
                    <div class="card-body">
                        <h5 class="card-title">${val[1]}</h5>
                        <p class="card-text">PHP ${val[2]}</p>
                    </div>
                    </div>
                </div>
            `
            $('#loop-card').append(el_card)
        }
    })
}

function drink_cat(){
    $('#loop-card').html('')
    let key = $('#drink').text().toLowerCase()
    $('#name-cat').text('Drink')
    $.each(data, function(i, val){
        if(val[0] == key){
            const el_card = `
                <div class="col-md-3 mb-4 subCardParent" onclick="invoice_data('${val[4]}','${val[1]}',${val[2]})">
                    <div class="card">
                    <img src="assets/${val[4]}" class="card-img-top" height="200">
                    <div class="card-body">
                        <h5 class="card-title">${val[1]}</h5>
                        <p class="card-text">PHP ${val[2]}</p>
                    </div>
                    </div>
                </div>
            `
            $('#loop-card').append(el_card)
        }
    })
}

// push data array to invoice data
function invoice_data(img, name, price){
    let invoice_data = [img, name, price, 0]
    for(let i = 0; i < invoice_item.length; i++){
        if(name == invoice_item[i][1]){
            alert('has available')
            return
        }
    }
    invoice_item.push(invoice_data)
    show_invoice()
}

// loop invoice

//add mo to sa big space pag gusto mo may image yung kada product
// <img src="assets/${val[0]}" class="align-self-center mr-3" width="95">

function show_invoice(){
    $('#loop-invoice').html('')
    $('#total-item').html('')
    $.each(invoice_item, function(i, val){
        const el_media = `
            <div class="media mb-2">



                
                <div class="media-body">
                <h6 class="mt-0">${val[1]}</h6>
                <p>PHP <span>${val[2]}</span></p>
                </div>
                <p>Quantity </p>
                <input class="quantity mt-3" id="quantity" type="number" value="${Number(val[3])}">
                <button class="btn delete mt-2"><img src="https://img.icons8.com/wired/35/000000/trash.png"></button>
            </div>
        `
        const el_total = `
            <div class="media mb-2">




                
                 <div class="media-body">
                    <h6 class="mt-0">${val[1]}</h6>
                    <p>PHP <span">${val[2]}</span></p>
                    
                    <h6>Quantity: <span">${val[3]}</span> </h6>
                </div>
            </div>
        `
        $('#loop-invoice').append(el_media)
        $('#total-item').append(el_total)
    })
}


// counting based on quantity
$('#loop-invoice').on('change','.quantity',function(){
    if(isNaN($(this).val()) || $(this).val() <= 0){
        $(this).val(0)
    }

    input_postion = $(".quantity").index(this)
    invoice_item[input_postion][3] = $(this).val()
    counting()
    show_invoice()
})

// counting
function counting (){
    sub_total = 0
    $.each(invoice_item, function(i, val){
        sub_total += val[2] * val[3]
        tax = sub_total * 0.02
        total = sub_total + tax
        $('#tax').text(tax)
        $('#total').text(total)
    })
}

// input money
$('#money').keypress(function(){
    if (event.keyCode == 13) {
        buy()
    }
})
$('#buy').on('click', buy)

// counting total
function buy(){
    let money = $('#money').val()
    let type = $('#buy-type').val()
    let change = money - total
    if(money == ''){
        alert('Insert The Money')
        return
    }else if(money <= total){
        alert('your money not enough')
        return
    }else if(isNaN(money)){
        alert("can't counting this value")
        return
    }
    let confirm_invoice = confirm('hi! '+ 'user' +', are you sure for the costumer\'s order?\nClick Yes to confirm')
    if(confirm_invoice == true){
        $('#tax-in').text(tax)
        $('#total-in').text(total)
        $('#total-type').text(type)
        $('#money-in').text(money)
        $('#change-in').text(change)
        $('#money').val('')
        $('#money').attr('placeholder', 'Insert Your Money')
        $('#modal-invoice').modal('show')
    }else{
        alert('BE CAREFUL')
        remove_invoice()
    }
}

// delete invoice based on target
$('#loop-invoice').on('click', '.delete', function(){
    let event = $('.delete').index(this)
    invoice_item.splice(event, 1)
    reset_amount()
    counting()
    show_invoice()
})


// delete all invoice
function remove_invoice(){
    $.each(invoice_item, function(i){
        invoice_item.splice(i, 1)
        invoice_item.shift()
        reset_amount()
    })
    show_invoice()
}

function reset_amount(){
    if(invoice_item == ''){
        $('#tax').text(0)
        $('#total').text(0)
    }
}

$('#end-payment').on('click', remove_invoice)
















    </script>


    
  </body>
              </html>
